{% extends "account/base_manage.html" %}
{% load i18n crispy_forms_tags %}

{% block head_title %}{% trans "Setup Two-Factor Authentication" %}{% endblock %}

{% block main_content %}
    <div class="sm:w-full sm:max-w-2xl">
        <h2 class="text-xl font-bold tracking-tight text-gray-900 px-6 pt-6 sm:px-12">
            {% trans "Setup Two-Factor Authentication" %}
        </h2>
    </div>

    <div class="sm:mx-auto sm:w-full px-6 py-8 sm:px-12">

        <!-- Step 1: Scan QR Code -->
        <div class="mb-8">
            <h3 class="text-base font-semibold text-gray-900 mb-4">
                {% trans "Step 1: Scan QR Code" %}
            </h3>
            <p class="text-sm text-gray-600 mb-4">
                {% trans "Open your authenticator app and scan this QR code:" %}
            </p>

            <div class="flex justify-center p-6 bg-white border-2 border-gray-200 rounded-lg">
                <img src="{{ qr_code }}" alt="QR Code" class="w-48 h-48" />
            </div>

            <div class="mt-4 p-4 bg-gray-50 rounded-lg">
                <p class="text-xs font-semibold text-gray-700 mb-2">
                    {% trans "Can't scan the code?" %}
                </p>
                <p class="text-xs text-gray-600 mb-2">
                    {% trans "Enter this code manually in your authenticator app:" %}
                </p>
                <code class="block p-2 bg-white border border-gray-300 rounded font-mono text-sm break-all">
                    {{ secret_key }}
                </code>
            </div>
        </div>

        <!-- Step 2: Verify Code -->
        <div class="mb-8">
            <h3 class="text-base font-semibold text-gray-900 mb-4">
                {% trans "Step 2: Verify Code" %}
            </h3>
            <p class="text-sm text-gray-600 mb-4">
                {% trans "Enter the 6-digit code from your authenticator app to verify the setup:" %}
            </p>

            <form method="post" action="{% url 'account_otp_verify_setup' %}">
                {% csrf_token %}
                {% crispy form %}
            </form>
        </div>

        <div class="pt-6 border-t border-gray-200">
            <a href="{% url 'account_otp_settings' %}"
               class="text-sm text-gray-600 hover:text-gray-900">
                {% trans "Cancel and go back" %}
            </a>
        </div>

    </div>
{% endblock %}
